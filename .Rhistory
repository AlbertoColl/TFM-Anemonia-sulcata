labs(title = "B.  DTD activity") +
theme(plot.title = element_text(hjust = -2.86))) # -2.35 left aligned
ggsave(paste0("./resultados/graficas_upd2/DTD.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p5 <- wrap_plots(plots[9:10]) +
labs(title = "B.  DTD activity") +
theme(plot.title = element_text(hjust = -2.87))) # -2.35 left aligned
ggsave(paste0("./resultados/graficas_upd2/DTD.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# GST + DTD
(p4 <- wrap_plots(plots[7:8]) +
labs(title = "A. GST activity") +
theme(plot.title = element_text(hjust = -2.87))) # -2.45 left aligned
ggsave(paste0("./resultados/graficas_upd2/GST.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# GST + DTD
(p4 <- wrap_plots(plots[7:8]) +
labs(title = "A. GST activity") +
theme(plot.title = element_text(hjust = -2.88))) # -2.45 left aligned
ggsave(paste0("./resultados/graficas_upd2/GST.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(pf_45 <-  p4/p5)
ggsave(paste0("./resultados/graficas_upd2/compuestaGSTDTD.png"), width = 180, height = 225, units = "mm", dpi = 1000)
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -0.75))) # -2.58 left aligned
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -0.75))) # -2.58 left aligned
ggsave(paste0("./resultados/graficas_upd2/G6PDH.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -2.8))) # -2.58 left aligned
ggsave(paste0("./resultados/graficas_upd2/G6PDH.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -3.1))) # -2.58 left aligned
ggsave(paste0("./resultados/graficas_upd2/G6PDH.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -3.3))) # -2.58 left aligned
ggsave(paste0("./resultados/graficas_upd2/G6PDH.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
# G6PDH gpx y gr
(p6 <- wrap_plots(plots[11:12]) +
labs(title = "C.  G6PDH activity") +
theme(plot.title = element_text(hjust = -3.31))) # -2.58 left aligned
ggsave(paste0("./resultados/graficas_upd2/G6PDH.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p9 <- wrap_plots(plots[19:20]) +
labs(title = "A.  GPx activity") +
theme(plot.title = element_text(hjust = -2.64))) # -2.44 left aligned
ggsave(paste0("./resultados/graficas_upd2/GPx.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p9 <- wrap_plots(plots[19:20]) +
labs(title = "A.  GPx activity") +
theme(plot.title = element_text(hjust = -2.84))) # -2.44 left aligned
ggsave(paste0("./resultados/graficas_upd2/GPx.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p9 <- wrap_plots(plots[19:20]) +
labs(title = "A.  GPx activity") +
theme(plot.title = element_text(hjust = -2.8))) # -2.44 left aligned
ggsave(paste0("./resultados/graficas_upd2/GPx.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.5))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.7))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.65))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.65))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.64))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(pf_9106 <-  p9/p10/p6)
ggsave(paste0("./resultados/graficas_upd2/compuestaGPxGRG6PDH.png"), width = 180, height = (225+112.5), units = "mm", dpi = 1000)
(p10 <- wrap_plots(plots[21:22]) +
labs(title = "B.  GR activity") +
theme(plot.title = element_text(hjust = -2.63))) # -2.16 left aligned
ggsave(paste0("./resultados/graficas_upd2/GR.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(pf_9106 <-  p9/p10/p6)
ggsave(paste0("./resultados/graficas_upd2/compuestaGPxGRG6PDH.png"), width = 180, height = (225+112.5), units = "mm", dpi = 1000)
(p8 <- wrap_plots(plots[17:18]) +
labs(title = "A.  Total Antioxidant Capacity (TEAC)") +
theme(plot.title = element_text(hjust = 8))) # 8 left aligned
(p8 <- wrap_plots(plots[17:18]) +
labs(title = "A.  Total Antioxidant Capacity (TEAC)") +
theme(plot.title = element_text(hjust = 6))) # 8 left aligned
ggsave(paste0("./resultados/graficas_upd2/TEAC.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p8 <- wrap_plots(plots[17:18]) +
labs(title = "A.  Total Antioxidant Capacity (TEAC)") +
theme(plot.title = element_text(hjust = 4))) # 8 left aligned
ggsave(paste0("./resultados/graficas_upd2/TEAC.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p8 <- wrap_plots(plots[17:18]) +
labs(title = "A.  Total Antioxidant Capacity (TEAC)") +
theme(plot.title = element_text(hjust = 5))) # 8 left aligned
ggsave(paste0("./resultados/graficas_upd2/TEAC.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p8 <- wrap_plots(plots[17:18]) +
labs(title = "A.  Total Antioxidant Capacity (TEAC)") +
theme(plot.title = element_text(hjust = 5.1))) # 8 left aligned
ggsave(paste0("./resultados/graficas_upd2/TEAC.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -1.3))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -2.3))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -1.8))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -1.9))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -1.89))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(p7 <- wrap_plots(plots[13:14]) +
labs(title = "B.  MDA") +
theme(plot.title = element_text(hjust =  -1.885))) # -1.62 left aligned
ggsave(paste0("./resultados/graficas_upd2/MDA.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
(pf_87 <-  p8/p7)
ggsave(paste0("./resultados/graficas_upd2/compuestaTEACMDA.png"), width = 180, height = 225, units = "mm", dpi = 1000)
datos_t <- read.csv2("./datos/datos_t_test.csv", numerals = "warn.loss", encoding = "latin1") %>%
mutate(tejido = as.factor(tejido))
datos.long <- datos_t %>%
select(-tratamiento, -n, -muestra, -proteina.pie) %>%
pivot_longer(-tejido, names_to = "variables", values_to = "value") %>%
mutate(value = as.double(value))
datos.long$variables <- factor(datos.long$variables, levels = c("SOD.pie", "CAT.pie", "GPx.pie", "GR.pie", "G6PDH.pie", "GST.pie", "DTD.pie", "TEAC.pie", "MDA.pie.2"), labels = c("SOD", "CAT", "GPx", "GR", "G6PDH", "GST", "DTD", "TEAC", "MDA"))
(paired.t.test <- datos.long  %>%
group_by(variables) %>%
t_test(value ~ tejido, paired = T) %>%
adjust_pvalue(method = "BH") %>%
add_significance())
paired.t.test <- paired.t.test %>% add_xy_position(x = "tejido", scales = "free", fun = "mean_sd")
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg",
ylab = "U/mg protein", xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg",
ylab = "U/mg protein", xlab = FALSE,
ggtheme = theme_tfm()) %>%
scale_x_discrete(labels = c("Column", "Tentacle")) +
facet(facet.by = "variables", nrow = 2, scales = "free") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg",
ylab = "U/mg protein", xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
ylab = "U/mg protein", xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
ylab = "U/mg protein", xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", strip.position = "left") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1, xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", strip.position = "left") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1, xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free") +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
?ggbarplot
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
ylab = c("1", "2", "3", "4", "5", "6", "7", "8", "9"), xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
ylab = c("1", "2", "3", "4", "5", "6", "7", "8", "9"),
xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
ylab = colnames(datos_t[5:14]),
xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
?facet
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se")
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se")
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
xlab = FALSE, ylab = "variables",
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
datos_t
View(datos_t)
datos_t <- read.csv2("./datos/datos_t_test.csv", numerals = "warn.loss", encoding = "latin1") %>%
mutate(tejido = as.factor(tejido))
datos_t <- read.csv2("./datos/datos_t_test.csv", numerals = "warn.loss", encoding = "latin1", dec = ".") %>%
mutate(tejido = as.factor(tejido),
tratamiento = as.factor(tratamiento))
colnames(datos_t) <- c("n", "muestra", "tratamiento", "tejido", "SOD", "CAT", "GST", "DTD", "G6PDH", "MDA", "proteina", "TEAC", "GPX", "GR")
View(datos_t)
datos_t %>%
group_by(tejido) %>%
get_summary_stats(type = "mean_se")
group_by(datos_t, tejido)
?summarise
install.packages("plotrix")
library(plotrix)
group_by(datos_t, tejido) %>%
summarise(SODm = mean(SOD),
SODse = std.error(SOD),
CATm = mean(CAT),
CATse = std.error(CAT),
GSTm = mean(GST),
GSTse = std.error(GST),
DTDm = mean(DTD),
DTDse = std.error(DTD),
G6PDHm = mean(G6PDG),
G6PDHse = std.error(G6PDH),
GPxm = mean(GPx),
GPxse = std.error(GPx),
GRm = mean(GR),
GRse = std.error(GR),
TEACm = mean(TEAC),
TEACse = std.error(TEAC),
MDAm = mean(MDA),
MDAse = std.error(MDA),)
group_by(datos_t, tejido) %>%
summarise(SODm = mean(SOD),
SODse = std.error(SOD),
CATm = mean(CAT),
CATse = std.error(CAT),
GSTm = mean(GST),
GSTse = std.error(GST),
DTDm = mean(DTD),
DTDse = std.error(DTD),
G6PDHm = mean(G6PDH),
G6PDHse = std.error(G6PDH),
GPxm = mean(GPx),
GPxse = std.error(GPx),
GRm = mean(GR),
GRse = std.error(GR),
TEACm = mean(TEAC),
TEACse = std.error(TEAC),
MDAm = mean(MDA),
MDAse = std.error(MDA),)
group_by(datos_t, tejido) %>%
summarise(SODm = mean(SOD),
SODse = std.error(SOD),
CATm = mean(CAT),
CATse = std.error(CAT),
GSTm = mean(GST),
GSTse = std.error(GST),
DTDm = mean(DTD),
DTDse = std.error(DTD),
G6PDHm = mean(G6PDH),
G6PDHse = std.error(G6PDH),
GPXm = mean(GPX),
GPXse = std.error(GPX),
GRm = mean(GR),
GRse = std.error(GR),
TEACm = mean(TEAC),
TEACse = std.error(TEAC),
MDAm = mean(MDA),
MDAse = std.error(MDA),)
datos_resumen <- group_by(datos_t, tejido) %>%
summarise(SODm = mean(SOD),
SODse = std.error(SOD),
CATm = mean(CAT),
CATse = std.error(CAT),
GSTm = mean(GST),
GSTse = std.error(GST),
DTDm = mean(DTD),
DTDse = std.error(DTD),
G6PDHm = mean(G6PDH),
G6PDHse = std.error(G6PDH),
GPXm = mean(GPX),
GPXse = std.error(GPX),
GRm = mean(GR),
GRse = std.error(GR),
TEACm = mean(TEAC),
TEACse = std.error(TEAC),
MDAm = mean(MDA),
MDAse = std.error(MDA),)
datos.long %>%
group_by(variables, tejido) %>%
get_summary_stats(type = "mean_se") %>%
ggbarplot(x = "tejido", y = "mean",
fill = "tejido", color = "tejido",
alpha = 0.2, legend = "none",  palette = "npg", linewidth = 1,
xlab = FALSE,
ggtheme = theme_tfm()) %>%
facet(facet.by = "variables", nrow = 2, scales = "free", ) +
geom_errorbar(aes(x = tejido, color = tejido, ymin = mean, max = mean+se),width = 0.3) +
scale_x_discrete(labels = c("Column", "Tentacle")) +
stat_pvalue_manual(paired.t.test, label = "p.adj.signif",
hide.ns = T)
ggsave(paste0("./resultados/graficas_upd2/T_TEST.png"), width = 180, height = 112.5, units = "mm", dpi = 1000)
ggsave(paste0("./resultados/graficas_upd2/T_TEST.svg"), width = 180, height = 112.5, units = "mm", dpi = 1000)
### SETUP ----
library(tidyverse)
library(rstatix)
library(ggpubr)
library(multcompView)
#setwd("D:/collf/Documents/GitHub/TFM-Anemonia-sulcata") # portatil
setwd("C:/Users/Usuario/Documents/GitHub/TFM-Anemonia-sulcata")  # lab
datos_c <- read.csv2("./datos/datos_peso_REVISION.csv", numerals = "warn.loss", encoding = "latin1")%>%
mutate(tratamiento = as.factor(tratamiento))
summary(datos_c)
source(file = "./scripts_enero_2024/1_funciones_graficas.R")
datos_c$tratamiento <- factor(datos_c$tratamiento, levels = c("Control", "Oscuro", "Salobre", "IMTA"), labels = c("Control", "LS", "BW", "IMTA"))
### Exploración de datos ----
# Observamos la distribución de los datos en general y por grupo
hist(datos_c$incremento.n)
datos_c %>%
group_by(tratamiento) %>%
shapiro_test(incremento.n)
# Ambas variable respuesta (incrmento en n y ganancia de peso total son normales en los tratamientos salvo la ganancia de peso para el IMTA.
## Comprobacion de outliers
outliers <- datos_c %>%
group_by(tratamiento) %>%
identify_outliers(ganancia.de.peso.total..g.)
# Hay 3 potenciales outliers, uno de ellos extremo en el grupo contol. Los otros dos en el grupo Control e IMTA. El dato de IMTA es el que afecta a la normalidad.
### Graficas iniciales----
# Estadisticos de resumen para las graficas
tabla_sum_1 <- datos_c %>%
group_by(tratamiento)  %>%
get_summary_stats(ganancia.de.peso.total..g., type = "mean_se")
tabla_sum_2 <- datos_c %>%
group_by(tratamiento)  %>%
get_summary_stats(incremento.n, type = "mean_se")
# Boxplot rapido
(ggboxplot(datos_c, x = "tratamiento", y = "incremento.n",
add = "point", color = "tratamiento"))
(ggboxplot(datos_c, x = "tratamiento", y = "ganancia.de.peso.total..g.",
add = "point", color = "tratamiento"))
# De barras:
# Para ganancia de peso
ggplot(tabla_sum_1) +
geom_col(aes(x = tratamiento, y = mean, fill = tratamiento), alpha = 1, width = 0.8) +
geom_errorbar(aes(x = tratamiento, y = mean, ymax = mean + se, ymin = mean - se), width = 0.4, color = "gray45") +
geom_hline(yintercept=0, linetype="dashed")
# Para incremento de n
ggplot(tabla_sum_2) +
geom_col(aes(x = tratamiento, y = mean, fill = tratamiento), alpha = 1, width = 0.8) +
geom_errorbar(aes(x = tratamiento, y = mean, ymax = mean + se, ymin = mean - se), width = 0.4, color = "gray45") +
geom_hline(yintercept=0, linetype="dashed")
### Anova de una via ----
peso.anova <- anova_test(data = datos_c, formula = ganancia.de.peso.total..g. ~ tratamiento)
get_anova_table(peso.anova)
n.anova <- anova_test(data = datos_c, formula = incremento.n ~ tratamiento)
get_anova_table(n.anova)
# Como el peso sale cercano a 0.05 hay ambiguedad en torno a si existen diferencias significativas entre tratamientos. Como el análisis de outliers reveló puntos potencialmente influyentes, vamos a comprobar si afectan al resultado del análisis.
# No parece que los outliers resuelvan la ambiguedad en el peso. Mejor no quitarlos, salvo igual el 3 solo porque afecta a la normalidad
# Outlier 3: no extremo pero afecta normalidad, baja p valor pero sigue muy amiguo
datos_c$ganancia.de.peso.total..g.[6] <- NA
datos_c$ganancia.de.peso.total..g.[3] <- NA
peso.anova <- anova_test(data = datos_c, formula = ganancia.de.peso.total..g. ~ tratamiento, type = 3)
get_anova_table(peso.anova)
### Post-hoc test----
# Solo para numero de individuos
anova1 <- aov(data = datos_c, incremento.n ~ tratamiento)
cld = multcompLetters4(anova1, TukeyHSD(anova1), reversed = T)
letras <- rownames_to_column(as.data.frame(cld$tratamiento$Letters))
colnames(letras) <- c("tratamiento", "tukey")
tabla_sum_2 <- merge(tabla_sum_2, letras)
# Graficas final----
# DIFERENCIA NUMERO INDIVIDUOS
ggplot(tabla_sum_2, aes(x = tratamiento)) +
geom_col(aes(y = mean, fill = tratamiento, color = tratamiento), alpha = 0.1, linewidth = 1) +
geom_errorbar(aes(ymax = mean + se, ymin = mean-se), width = 0.5, color = "gray35") +
geom_text(aes(y = (mean+3*se),label = tukey, x = tratamiento), size = 4, fontface = "bold") +
xlab(NULL) +
ylim(c(-5, 11)) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_tfm() +
ylab("Difference in total number of individuals") +
#labs_pubr() +
guides(fill = "none") +
scale_fill_manual(values = c("#0c8890", "#54B65D","#E56A1C", "#FBBC4C")) +
scale_color_manual(values = c("#0c8890", "#54B65D","#E56A1C", "#FBBC4C"))
# INCREMENTO DE PESO
ggplot(tabla_sum_1, aes(x = tratamiento)) +
geom_col(aes(y = mean, fill = tratamiento, color = tratamiento), alpha = 0.1, linewidth = 1) +
geom_errorbar(aes(ymax = mean + se, ymin = mean-se), width = 0.5, color = "gray35") +
#geom_text(aes(y = (mean+3*se),label = tukey, x = tratamiento), size = 4, fontface = "bold") +
xlab(NULL) +
#ylim(c(-5, 11)) +
geom_hline(yintercept = 0, linetype = "dashed") +
theme_tfm() +
ylab("Change in Total Weight (g)") +
labs_pubr() +
guides(fill = "none") +
scale_fill_manual(values = c("#0c8890", "#54B65D","#E56A1C", "#FBBC4C")) +
scale_color_manual(values = c("#0c8890", "#54B65D","#E56A1C", "#FBBC4C"))
