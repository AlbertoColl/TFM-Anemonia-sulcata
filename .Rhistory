## SETUP ----
library(tidyverse)
setwd("C:/Users/Usuario/Documents/GitHub/TFM-Anemonia-sulcata")
source(file = "./scripts_enero_2024/0_data_lab.R") # Laboratorio
library(GGally) # Correlograma
library(tidyverse)
setwd("C:/Users/Usuario/Documents/GitHub/TFM-Anemonia-sulcata")
source(file = "./scripts_enero_2024/0_data_lab.R") # Laboratorio
#source(file = "./scripts/0_data_home.R") # En casa
source(file = "./scripts_enero_2024/1_funciones_graficas.R")
ggthemr("fresh")
View(datos)
datos <- datos %>% select(-c(MDA.pie, MDA.tent)) # Primera medida de MDA no vale
datos[5:20]
datos[,5:20]
### Matriz de correlacion ----
datos_cor <- cor(datos[,5:21])
View(datos_cor)
library(psych)
install.packages("psych")
library(psych)
cor.plot(datos_cor)
det(datos_cor)
install.packages("MVN")
library(MVN)
mvn(datos[,5:21], "mardia")
mvn(datos[,5:21], mvnTest = "mardia")
mvn(datos[,6:21], mvnTest = "mardia")
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:21])
cortest.bartlett(datos[,6:21], nrow(datos))
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:21])
KMO(datos_cor)
cp <- princomp(~., data = datos[,6:21], cor = TRUE)
cp$loadings
summary(cp)
screeplot(cp)
# 4 componentes ya superan 70 % varianza
win.graph()
screeplot(cp)
screeplot(cp, type = "lines")
cp$sdev^2
install.packages("factoextra")
library(factoextra)
fviz_pca_biplot(cp)
fviz_pca_biplot(cp)
fviz_pca_var(cp)
### AÃ±adimos a los datos ----
datos <- cbind(datos, cp1 = cp$scores[,1], cp2 = cp$scores[,2], cp3 = cp$scores[,3], cp4 = cp$scores[,4])
View(datos)
fviz_pca_biplot(cp)
datos_scl <- scale(datos[,6:21])
View(datos_scl)
distancia <- dist(datos_scl)
ac <- hclust(distancia)
win.graph()
plot(ac)
fviz_nbclust(datos_scl, kmeans, method = "wss")
set.seed(999)
ac.2 <- kmeans(as.matrix(datos_scl), 5)
ac.2
fviz_cluster(datos_scl, ellipse.type = "norm")
fviz_cluster(ac.2, datos_scl, ellipse.type = "norm")
win.graph()
fviz_cluster(ac.2, datos_scl, ellipse.type = "norm")
fviz_nbclust(datos_scl, kmeans, method = "wss")
set.seed(999)
ac.2 <- kmeans(as.matrix(datos_scl), 4)
ac.2
win.graph()
fviz_cluster(ac.2, datos_scl, ellipse.type = "norm")
datos[8,]
datos[8,]
datos[-8]
datos[-8,]
datos[-8,]
datos <- datos[-8,]
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:21])
cor.plot(datos_cor)
det(datos_cor)
win.graph()
cor.plot(datos_cor)
det(datos_cor)
mvn(datos[,6:21], mvnTest = "mardia") # normalidad un poco eee
cortest.bartlett(datos[,6:21], nrow(datos))
KMO(datos_cor) # podemos considerar quitar gps tent pero esta bien
cp <- princomp(~., data = datos[,6:21], cor = TRUE)
cp$loadings
summary(cp)
# 4 componentes ya superan 70 % varianza
win.graph()
screeplot(cp, type = "lines") # 4 o 5 componentes
datos_scl <- scale(datos[,6:21])
distancia <- dist(datos_scl)
ac <- hclust(distancia)
win.graph()
plot(ac)
fviz_nbclust(datos_scl, kmeans, method = "wss")
set.seed(999)
ac.2 <- kmeans(as.matrix(datos_scl), 4)
ac.2
win.graph()
fviz_cluster(ac.2, datos_scl, ellipse.type = "norm")
