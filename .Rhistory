### SETUP ----
library(tidyverse)
library(psych) #correlacion
library(MVN)
library(factoextra)
setwd("C:/Users/Usuario/Documents/GitHub/TFM-Anemonia-sulcata")
source(file = "./scripts_enero_2024/0_data_lab.R") # Laboratorio
source(file = "./scripts_enero_2024/1_funciones_graficas.R")
ggthemr("fresh")
datos <- datos %>% select(-c(MDA.pie, MDA.tent)) # Primera medida de MDA no vale
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:21])
win.graph()
cor.plot(datos_cor)
det(datos_cor)
mvn(datos[,6:21], mvnTest = "mardia") # normalidad un poco eee
cortest.bartlett(datos[,6:21], nrow(datos))
KMO(datos_cor) # podemos considerar quitar gps tent pero esta bien
select(datos_cor, -GST.tent)
select(as.dataframe(datos_cor, -GST.tent))
select(as.data.frame(datos_cor, -GST.tent))
View(datos_cor)
select(datos, -GST.tent)
select(datos, -GST.tent)[,6:20]
KMO(cor(select(datos, -GST.tent)[,6:20]))
cp <- princomp(~., data = datos[,6:21], cor = TRUE)
summary(cp)
G
### Modelo PCA y eleccion de numero de componentes ----
cp2 <- princomp(~., data = select(datos, -GST.tent)[,6:20], cor = TRUE)
summary(cp2)
cp$loadings
# 4 componentes ya superan 70 % varianza
win.graph()
screeplot(cp, type = "lines") # 4 o 5 componentes
cp$sdev^2 # 5 componentes segun regla de Kaiser
screeplot(cp2, type = "lines") # 4 o 5 componentes
# 4 componentes ya superan 70 % varianza
win.graph()
screeplot(cp2, type = "lines") # 4 o 5 componentes
cp2$sdev^2 # 5 componentes segun regla de Kaiser
fviz_pca_biplot(cp2)
fviz_pca_var(cp2)
cp2$loadings
print(cp2$loadings, cutoff = 0)
write.csv2(cp2$loadings)
a <- write.csv2(cp2$loadings)
?write.csv2()
a <- write.csv2(cp2$loadings, file = "./resultados/cargas.factoriales.sing.gst.tent.csv")
write.csv2(cp2$loadings, file = "./resultados/cargas.factoriales.sing.gst.tent.csv")
fviz_pca_biplot(cp2)
datos <- datos[-8,] # Este punto influencia mucho el anÃ¡lisis, parece ser
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:21])
det(datos_cor)
mvn(datos[,6:21], mvnTest = "mardia") # normalidad un poco eee
cortest.bartlett(datos[,6:21], nrow(datos))
KMO(datos_cor) # podemos considerar quitar gst tent pero esta bien
source(file = "./scripts_enero_2024/0_data_lab.R") # Laboratorio
source(file = "./scripts_enero_2024/1_funciones_graficas.R")
ggthemr("fresh")
datos <- datos %>% select(-c(MDA.pie, MDA.tent)) # Primera medida de MDA no vale
mvn(datos[,6:21], mvnTest = "mardia") # normalidad un poco eee
mvn(select(datos, -GST.tent)[,6:21], mvnTest = "mardia") # normalidad un poco eee
mvn(select(datos, -GST.tent)[,6:20], mvnTest = "mardia") # normalidad un poco eee
cortest.bartlett(select(datos, -GST.tent)[,6:20], nrow(datos))
KMO(datos_cor) # podemos considerar quitar gst tent pero esta bien
KMO(cor(select(datos, -GST.tent)[,6:20]))
setwd("C:/Users/Usuario/Documents/GitHub/TFM-Anemonia-sulcata")
source(file = "./scripts_enero_2024/0_data_lab.R") # Laboratorio
source(file = "./scripts_enero_2024/1_funciones_graficas.R")
ggthemr("fresh")
datos <- datos %>% select(-c(MDA.pie, MDA.tent)) # Primera medida de MDA no vale
View(datos)
### Matriz de correlacion ----
datos_cor <- cor(datos[,5:20])
win.graph()
cor.plot(datos_cor)
det(datos_cor)
mvn(select(datos, -GST.tent)[,6:20], mvnTest = "mardia") # normalidad un poco eee
cortest.bartlett(datos[,6:20], nrow(datos))
KMO(datos_cor) # podemos considerar quitar gst tent pero esta bien
### Matriz de correlacion ----
datos_cor <- cor(datos[,6:20])
View(datos_cor)
KMO(datos_cor) # podemos considerar quitar gst tent pero esta bien
### Modelo PCA y eleccion de numero de componentes ----
cp2 <- princomp(~., data = select(datos, -GST.tent)[,6:20], cor = TRUE)
### Modelo PCA y eleccion de numero de componentes ----
cp <- princomp(~., data = datos[,6:20], cor = TRUE)
cp2$loadings
write.csv2(cp2$loadings, file = "./resultados/cargas.factoriales.sing.gst.tent.csv")
summary(cp2)
write.csv2(cp2$loadings, file = "./resultados/cargas.factoriales.sing.gst.tent.csv")
summary(cp2)
# 4 componentes ya superan 70 % varianza
win.graph()
screeplot(cp2, type = "lines") # 4 o 5 componentes
cp$sdev^2 # 5 componentes segun regla de Kaiser
fviz_pca_biplot(cp2)
fviz_pca_var(cp2)
?fviz_pca_var()
fviz_pca_var(cp2,geom = "point")
fviz_pca_var(cp2,geom = "line")
fviz_pca_var(cp2,geom = "text")
fviz_pca_var(cp2)
fviz_pca_var(cp2, addEllipses = T)
fviz_pca_var(cp2, col.var = "blue")
fviz_pca_var(cp2, fill.var = "blue")
fviz_pca_var(cp2, col.var = "blue")
fviz_pca_var(cp2, col.var = "royalblue4")
fviz_pca_var(cp2, col.var = "steelblue")
fviz_pca_var(cp2, col.var = "steelblue", col.circle = "grey40")
fviz_pca_biplot(cp2, palette = ggthemr_palette("fresh"))
fviz_pca_biplot(cp2, palette = ggthemr_palette("steelblue"))
