}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.2*(max(tabla_summ$media)+ max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.2*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.4*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.5*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.3*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.35*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.35*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.32*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.33*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.33*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.34*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.35*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
barras_tfm <- function(){
ggplot() +
geom_errorbar(data = tabla_summ, aes(x = tratamiento, ymax = media + error, ymin = media- error), width = 0.7, color = "gray55") +
geom_col(data = tabla_summ, aes(x = tratamiento, y = media, fill = tratamiento, color = tratamiento),  alpha = 0.1, linewidth = 1) +
geom_point(data = datos, aes(x = tratamiento, y = get(i), color = tratamiento), alpha = 0.8, size = 2) +
geom_text(data = tabla_summ, aes(x = tratamiento, y = media + error, label = tukey), color = "grey5", vjust = -0.8, size = 4.5, fontface = "bold") +
ylab(case_when(
i == "clorofila.total" ~ "μg clorofila /g tejido",
i == "proteina.tent" | i == "proteina.pie"  ~ " mg proteína / ml",
i == "MDA.pie.2" | i == "MDA.tent.2" ~ "μM  MDA",
i == "TEAC.pie" | i == "TEAC.tent"~ "μM equivalentes de Trolox",
i == "GST.pie" | i == "GST.tent" ~ "mU / mg  de proteína",
i == "DTD.pie" | i == "DTD.tent" ~ "mU / mg  de proteína",
TRUE ~ "U / mg  de proteína")) +
xlab("Tratamiento") +
scale_color_manual(values = c("#0c8890", "#3EB59B","#E56A1C", "#FBBC4C")) +
ylim(c(0, 1.35*(max(tabla_summ$media) + max(tabla_summ$error)))) +
# Colores 1
#scale_fill_manual(values = c("#414066", "#69B4AB", "#FBBC4C", "#EF476F")) + # Colores 2
#scale_fill_manual(values = c("#1E5D56", "#0C8890", "#3EB59B", "#FBBC4C")) + # Colores 3
# ylim(c(0, case_when(i == "CAT.pie" ~  90,i == "DTD.pie" ~  15,i == "GST.pie" ~  450,i == "MDA.pie.2"| i == "MDA.tent.2" ~  90,i == "SOD.pie"| i == "SOD.tent" ~  150,  i == "TEAC.pie"| i == "TEAC.tent" ~  500,i == "CAT.tent" | i == "DTD.tent" | i == "GST.tent" ~ max(tabla_summ$media) * 2, TRUE ~ max(tabla_summ$media) * 1.2))) +
labs(title = i) +
theme_tfm()
}
# Bucle construccion de estadisticos de resumen, grafica y test post hoc Tukey
for (n in c(1:18)) {
i <- colnames(datos[4:21])[[n]]
tabla_summ <- datos %>%  group_by(tratamiento) %>%
summarise(media = mean(get(i), na.rm = T),
desvest = sd(get(i), na.rm = T),
error = desvest/sqrt(sum(!is.na(get(i)))))
if ((summary(modelos[[n]])[[1]][["Pr(>F)"]][1]) <= 0.05) {
tukey_loop <- TukeyHSD(modelos[[n]])
cld.tukey <- multcompLetters4(modelos[[n]], tukey_loop, reversed = T)
(letras <- rownames_to_column(as.data.frame(cld.tukey$tratamiento$Letters)))
colnames(letras) <- c("tratamiento", "tukey")
tabla_summ <- merge(tabla_summ, letras)
} else {
tabla_summ$tukey <- c("", "", "", "")
}
(p <- barras_tfm())
ggsave(paste0("./resultados/graficas2/", i, ".png"), width = 800, height = 1000, units = "px", #para clorofila 730, 730
scale = 2, dpi = "retina")
}
